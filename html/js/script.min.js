function qa(e){return document.querySelectorAll(e)}function q(e){return document.querySelector(e)}function OpenDownList(){q(".downlist-cover").style.display="block",setTimeout(()=>{q(".downlist-cover").style.opacity=1,q(".downlist-window").style.top="15%"},50)}function CloseDownList(){q(".downlist-cover").style.opacity=0,q(".downlist-window").style.top="calc(15% + 2rem)",setTimeout(()=>{q(".downlist-cover").style.display="none"},500)}function RequireScan(){fetch("/scan")}function HTMLEncode(e){var t=document.createElement("div");null!=t.textContent?t.textContent=e:t.innerText=e;var o=t.innerHTML;return t=null,o}function ClearVideos(){shown_videos={},e=qa(".item");for(var t=1;t<e.length;t++)e[t].remove()}function AddVideo(e,t){if(null==shown_videos[e]){id=++count;var o=document.createElement("div");o.setAttribute("class","item"),o.setAttribute("id","item"+id),o.style.opacity="0",o.style.height="0";var i=[];for(n=0;n<t.length;n++)i.push(HTMLEncode(t[n]));o.innerHTML='<input type="checkbox" class="select-vid"><div class="vid-container"><video-js oncontextmenu="return false" controls id="video'+id+'"><source src="'+e+'"></video-js></div><div class="item-opt"><div class="filename"></div><input class="input-filename" id="filename'+id+'" list="list'+id+'"><datalist id="list'+id+'"><option>'+i.join("</option><option>")+'</option></datalist><div class="fileext"></div><select class="select-fileext"><option>.mp4</option><option>.mkv</option><option>.m4v</option><option>.flv</option></select><button class="btn">Download</button>',q(".content").appendChild(o);for(n=0;n<i.length;n++)if(!i[n].toLowerCase().includes("classin")&&!i[n].toLowerCase().includes("classroom")){q("#filename"+id).value=i[n];break}shown_videos[e]={titles:t,id:id},videojs("video"+id),setTimeout(()=>{o.style.opacity="1",o.style.height=""},50)}else for(var n=0;n<t.length;n++)shown_videos[e].titles.includes(t[n])||(q("#list"+shown_videos[e].id).innerHTML+="<option>"+HTMLEncode(t[n])+"</option>",shown_videos[e].titles.push(t[n]))}function GetVideos(e=!0){fetch("/get-titles").then(e=>e.json()).then(t=>{for(var o in t)AddVideo(o,t[o]);e&&setTimeout(GetVideos,1e3)})}function StartModify(){modifying=!0,clearTimeout(modify_timeout),q(".delay-int").style.boxShadow="0 0 2px 2px #e04",modify_timeout=setTimeout(StopModify,1e4)}function StopModify(){ChangeDelayTime(),modifying=!1,clearTimeout(modify_timeout),q(".delay-int").style.boxShadow=""}function RefreshStatus(){fetch("/get-status").then(e=>e.json(),()=>{setTimeout(RefreshStatus,300)}).then(e=>{q(".conf-panel>.check-big").checked=e.autoscan,modifying||(q(".delay-int").value=e.wait_interval),setTimeout(RefreshStatus,1e3)})}function SwitchAutoScan(){fetch(q(".conf-panel>.check-big").checked?"/enable-autoscan":"/disable-autoscan")}function ChangeDelayTime(){fetch("/set-autoscan-delay",{method:"POST",body:q(".delay-int").value.toString()})}var count=0,shown_videos={};GetVideos();var modifying=!1,modify_timeout=0,modify_focus=!1;RefreshStatus();